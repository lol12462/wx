-- Локальный скрипт для подсветки игроков через стены с обновлением каждые 3 секунды

local player = game.Players.LocalPlayer
local camera = game.Workspace.CurrentCamera
local players = game.Players

local highlightColor = Color3.fromRGB(255, 255, 0)  -- Цвет подсветки (желтый)

-- Функция для создания подсветки игрока
local function createGlowEffect(targetPlayer)
    local targetCharacter = targetPlayer.Character
    if targetCharacter then
        -- Создаем Highlight для подсветки
        local highlight = Instance.new("Highlight")
        highlight.Name = "GlowHighlight"
        highlight.Parent = targetCharacter
        highlight.Adornee = targetCharacter  -- Устанавливаем, что подсвечиваем
        highlight.FillColor = highlightColor  -- Цвет подсветки
        highlight.OutlineColor = highlightColor  -- Цвет контура подсветки
        highlight.FillTransparency = 0.5  -- Прозрачность
        highlight.OutlineTransparency = 0.5  -- Прозрачность контура
        highlight.Enabled = true  -- Включаем подсветку
    end
end

-- Функция для удаления подсветки
local function removeGlowEffect(targetPlayer)
    local targetCharacter = targetPlayer.Character
    if targetCharacter then
        -- Удаляем Highlight
        local highlight = targetCharacter:FindFirstChild("GlowHighlight")
        if highlight then
            highlight:Destroy()
        end
    end
end

-- Функция для применения эффекта ко всем игрокам
local function applyGlowToAllPlayers()
    for _, targetPlayer in pairs(players:GetPlayers()) do
        if targetPlayer ~= player then
            createGlowEffect(targetPlayer)
        end
    end
end

-- Обновление эффекта подсветки каждую секунду
local function updateGlowEffects()
    while true do
        for _, targetPlayer in pairs(players:GetPlayers()) do
            if targetPlayer ~= player then
                -- Удаляем старую подсветку и создаем новую
                removeGlowEffect(targetPlayer)
                createGlowEffect(targetPlayer)
            end
        end
        wait(3)  -- Обновляем подсветку каждые 3 секунды
    end
end

-- Применяем эффект сразу при старте
applyGlowToAllPlayers()

-- Применяем эффект, когда появляется новый игрок
players.PlayerAdded:Connect(function(newPlayer)
    if newPlayer ~= player then
        createGlowEffect(newPlayer)
    end
end)

-- Обновляем эффект при каждом респавне
player.CharacterAdded:Connect(function(newCharacter)
    -- Очищаем старые эффекты
    for _, child in pairs(newCharacter:GetChildren()) do
        if child:IsA("Highlight") then
            child:Destroy()
        end
    end
    -- Применяем эффект к новым частям
    applyGlowToAllPlayers()
end)

-- Очищаем эффекты, когда игрок уходит
players.PlayerRemoving:Connect(function(leavingPlayer)
    if leavingPlayer ~= player then
        removeGlowEffect(leavingPlayer)
    end
end)

-- Запуск обновления эффектов
updateGlowEffects()
